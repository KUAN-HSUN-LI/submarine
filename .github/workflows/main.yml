name: Mysql

# Controls when the action will run.
on: push

jobs:
  build:
    runs-on: ubuntu-latest
    services:
      mysql:
        image: mysql:5.7
        env:
          MYSQL_DATABASE: test_db
          MYSQL_USER: user
          MYSQL_PASSWORD: secret
          MYSQL_ROOT_PASSWORD: secretroot
        options: --health-cmd="mysqladmin ping" --health-interval=10s --health-timeout=5s --health-retries=5
    steps:
      - name: Verify MySQL connection from host
        run: |
          mysql --version
          sudo apt-get install -y mysql-client
          mysql --host 127.0.0.1 --port ${{ job.services.mysql.ports['3306'] }} -uuser -psecret -e "SHOW DATABASES"
#         sudo mysql --port 8888 -e "CREATE DATABASE IF NOT EXISTS submarine_test;"
#     - name: mysql-data
#       run: sudo ./dev-support/database/init-database.sh
#       - name: Shutdown Ubuntu MySQL (SUDO)
#         run: sudo service mysql stop
#       - name: mysql-status2
#         run: sudo service mysql status
#       - name: mysql-start
#         run: |
#           sudo service mysql start
          
#       - name: mysql-status3
#         run: sudo service mysql status
